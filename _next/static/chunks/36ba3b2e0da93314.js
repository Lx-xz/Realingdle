(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8134,e=>{"use strict";var s=e.i(43476),a=e.i(71645),c=e.i(18566);function r({value:e,onChange:c,onSubmit:r,suggestions:l=[],onSelectSuggestion:t,noResultsText:i="No results",placeholder:n="Search character...",disabled:d=!1}){let m=(0,a.useRef)(null),[u,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=e=>{m.current&&(m.current.contains(e.target)||o(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let h=u&&e.trim().length>0,_=l.length>0;return(0,s.jsxs)("form",{className:"search-bar",onSubmit:s=>{s.preventDefault(),e.trim()&&(r(e.trim()),o(!1))},children:[(0,s.jsxs)("div",{className:"search-bar__field",ref:m,children:[(0,s.jsx)("input",{type:"text",className:"search-bar__input",value:e,onChange:e=>{c(e.target.value),o(!0)},onFocus:()=>o(!0),placeholder:n,disabled:d}),h&&(0,s.jsx)("div",{className:"search-bar__dropdown",children:_?(0,s.jsx)("ul",{className:"search-bar__list",children:l.map(e=>(0,s.jsx)("li",{className:"search-bar__item",children:(0,s.jsxs)("button",{type:"button",onClick:()=>{var s;return s=e.name,void(t?.(s),r(s),o(!1))},className:"search-bar__option",children:[e.image_url?(0,s.jsx)("img",{src:e.image_url,alt:e.name,className:"search-bar__avatar"}):(0,s.jsx)("span",{className:"search-bar__avatar search-bar__avatar--placeholder",children:e.name.charAt(0)}),(0,s.jsx)("span",{className:"search-bar__option-text",children:e.name})]})},e.name))}):(0,s.jsx)("div",{className:"search-bar__empty",children:i})})]}),(0,s.jsx)("button",{type:"submit",className:"search-bar__button",disabled:d||!e.trim(),children:"Guess"})]})}function l({lives:e,maxLives:a=10}){let c=Math.max(0,Math.min(100,e/a*100));return(0,s.jsxs)("div",{className:"life-bar",children:[(0,s.jsxs)("div",{className:"life-bar__label",children:["Lives: ",e,"/",a]}),(0,s.jsx)("div",{className:"life-bar__track",children:(0,s.jsx)("div",{className:"life-bar__fill",style:{width:`${c}%`}})})]})}var t=e.i(48978),i=e.i(1892),n=e.i(17927);function d(){let e=(0,c.useRouter)(),[d,m]=(0,a.useState)(""),[u,o]=(0,a.useState)(10),[h,_]=(0,a.useState)([]),[g,x]=(0,a.useState)(!1),[j,p]=(0,a.useState)(!1),[N,v]=(0,a.useState)(null),[w,b]=(0,a.useState)([]),[f,S]=(0,a.useState)(!0),[C,y]=(0,a.useState)(!1),L=()=>new Date().toISOString().slice(0,10),k="realingdle:game-state";(0,a.useEffect)(()=>{$()},[]),(0,a.useEffect)(()=>{(async()=>{let{data:e}=await n.supabase.auth.getSession();y(!!e.session)})();let{data:e}=n.supabase.auth.onAuthStateChange((e,s)=>{y(!!s)});return()=>{e.subscription.unsubscribe()}},[]);let $=async()=>{try{let e=await (0,i.fetchCharacters)({ascending:!0});if(b(e),e.length>0){let s=Math.floor((new Date().getTime()-new Date(new Date().getFullYear(),0,0).getTime())/864e5)%e.length,a=e[s];v(a);{let e=window.localStorage.getItem(k);if(e)try{let s=JSON.parse(e);s.dateKey===L()&&s.characterId===a.id?(_(s.guesses),o(s.lives),x(s.gameOver),p(s.won)):window.localStorage.removeItem(k)}catch{window.localStorage.removeItem(k)}}}}catch(e){console.error("Error fetching character:",e)}finally{S(!1)}};(0,a.useEffect)(()=>{if(!N)return;let e={dateKey:L(),characterId:N.id,guesses:h,lives:u,gameOver:g,won:j};window.localStorage.setItem(k,JSON.stringify(e))},[N,h,u,g,j]);let I=d.trim().length?w.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())).map(e=>({name:e.name,image_url:e.image_url})):[],O=(e,a,c="None")=>{let r=new Set(a.map(e=>e.id));return 0===e.length?(0,s.jsx)("span",{className:"guess-chip guess-chip--miss",children:c}):e.map(e=>(0,s.jsx)("span",{className:`guess-chip ${r.has(e.id)?"guess-chip--match":"guess-chip--miss"}`,children:e.name},e.id))};return f?(0,s.jsx)("div",{className:"game",children:(0,s.jsx)("div",{className:"game__container",children:(0,s.jsx)("p",{children:"Loading..."})})}):N?(0,s.jsx)("div",{className:"game",children:(0,s.jsxs)("div",{className:"game__container",children:[(0,s.jsx)("h1",{className:"game__title",children:"Guess the Character"}),(0,s.jsx)(l,{lives:u,maxLives:10}),!g&&(0,s.jsx)("div",{className:"game__search",children:(0,s.jsx)(r,{value:d,onChange:m,onSubmit:e=>{if(g||!N)return;let s=w.find(s=>s.name.toLowerCase()===e.toLowerCase());if(!s)return void m("");if(_([...h,s.name]),s.name.toLowerCase()===N.name.toLowerCase())p(!0),x(!0);else{let e=u-1;o(e),0===e&&x(!0)}m("")},suggestions:I,onSelectSuggestion:e=>m(e),noResultsText:"No characters found",disabled:g})}),g&&(0,s.jsxs)("div",{className:`game__result ${j?"game__result--win":"game__result--lose"}`,children:[(0,s.jsx)("h2",{children:j?"ðŸŽ‰ Congratulations!":"ðŸ˜¢ Game Over"}),(0,s.jsx)("p",{children:j?`You guessed the character "${N.name}" correctly!`:`The character was "${N.name}"`}),(C||!j)&&(0,s.jsx)("div",{className:"game__actions",children:(0,s.jsx)(t.default,{onClick:()=>{o(10),_([]),x(!1),p(!1),m(""),window.localStorage.removeItem(k),$()},children:"Play Again"})})]}),(0,s.jsx)("div",{className:"game__guesses",children:(0,s.jsx)("ul",{className:"game__guesses-list",children:[...h].reverse().map((e,a)=>{let c=w.find(s=>s.name.toLowerCase()===e.toLowerCase())||null,r=c?.id===N?.id||e.toLowerCase()===N?.name.toLowerCase();if(!c||!N)return(0,s.jsxs)("li",{className:"game__guess-card game__guess-card--unknown",children:[(0,s.jsxs)("div",{className:"game__guess-header",children:[(0,s.jsx)("span",{className:"game__guess-name",children:e}),(0,s.jsx)("span",{className:"game__guess-status",children:"Unknown"})]}),(0,s.jsx)("p",{className:"game__guess-missing",children:"Character not found."})]},a);let l={state:c.state?.id===N.state?.id,age:(c.age??null)===(N.age??null)},t=c.image_url?{"--guess-image":`url(${c.image_url})`}:void 0;return(0,s.jsx)("li",{className:`game__guess-card ${r?"game__guess-card--correct":"game__guess-card--wrong"}`,style:t,children:(0,s.jsx)("div",{className:"guess-card__content",children:(0,s.jsxs)("div",{className:"guess-card__info",children:[(0,s.jsxs)("div",{className:"guess-card__title",children:[(0,s.jsx)("h4",{children:c.name}),c.description&&(0,s.jsxs)("p",{className:"guess-card__quote",children:["â€œ",c.description,"â€"]})]}),(0,s.jsxs)("div",{className:"guess-card__row-group",children:[(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Age"}),(0,s.jsx)("div",{className:"guess-card__chips",children:(0,s.jsx)("span",{className:`guess-chip ${l.age?"guess-chip--match":"guess-chip--miss"}`,children:c.age??"-"})})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"State"}),(0,s.jsx)("div",{className:"guess-card__chips",children:(0,s.jsx)("span",{className:`guess-chip ${l.state?"guess-chip--match":"guess-chip--miss"}`,children:c.state?.name||"-"})})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Classes"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.classes,N.classes)})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Races"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.races,N.races)})]})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--stacked",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Occupations"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.occupations,N.occupations)})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--stacked",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Associations"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.associations,N.associations)})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--stacked",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Places"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.places,N.places)})]})]})})},a)})})})]})}):(0,s.jsx)("div",{className:"game",children:(0,s.jsxs)("div",{className:"game__container",children:[(0,s.jsx)("h2",{children:"No characters available"}),(0,s.jsx)("p",{children:"Please contact the administrator to add characters."}),(0,s.jsx)(t.default,{onClick:()=>e.push("/"),children:"Back to Home"})]})})}e.s(["default",()=>d],8134)}]);