(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,97936,e=>{"use strict";var s=e.i(43476);function a({children:e,onClick:a,type:c="button",variant:r="primary",disabled:t=!1}){return(0,s.jsx)("button",{className:`button button--${r}`,onClick:a,type:c,disabled:t,children:e})}e.s(["default",()=>a])},1892,e=>{"use strict";var s=e.i(17927);let a=`
  id,
  name,
  description,
  image_url,
  age,
  created_at,
  updated_at,
  state:states(id, name),
  classes:character_classes(class:classes(id, name)),
  races:character_races(race:races(id, name)),
  occupations:character_occupations(occupation:occupations(id, name)),
  associations:character_associations(association:associations(id, name)),
  places:character_places(place:places(id, name))
`,c=e=>({id:e.id,name:e.name,description:e.description,image_url:e.image_url,age:e.age,created_at:e.created_at,updated_at:e.updated_at,state:Array.isArray(e.state)?e.state[0]:e.state,classes:e.classes?.map(e=>e.class)??[],races:e.races?.map(e=>e.race)??[],occupations:e.occupations?.map(e=>e.occupation)??[],associations:e.associations?.map(e=>e.association)??[],places:e.places?.map(e=>e.place)??[]}),r=async(e={})=>{let{data:r,error:t}=await s.supabase.from("characters").select(a).order("name",{ascending:e.ascending??!0});if(t)throw t;return r.map(c)};e.s(["fetchCharacters",0,r])},8134,e=>{"use strict";var s=e.i(43476),a=e.i(71645),c=e.i(18566);function r({value:e,onChange:c,onSubmit:r,suggestions:t=[],onSelectSuggestion:i,noResultsText:l="No results",placeholder:n="Search character...",disabled:d=!1}){let o=(0,a.useRef)(null),[m,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=e=>{o.current&&(o.current.contains(e.target)||u(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let h=m&&e.trim().length>0,_=t.length>0;return(0,s.jsx)("form",{className:"search-bar",onSubmit:s=>{s.preventDefault(),e.trim()&&(r(e.trim()),u(!1))},children:(0,s.jsxs)("div",{className:"search-bar__field",ref:o,children:[(0,s.jsx)("input",{type:"text",className:"search-bar__input",value:e,onChange:e=>{c(e.target.value),u(!0)},onFocus:()=>u(!0),placeholder:n,disabled:d}),h&&(0,s.jsx)("div",{className:"search-bar__dropdown",children:_?(0,s.jsx)("ul",{className:"search-bar__list",children:t.map(e=>(0,s.jsx)("li",{className:"search-bar__item",children:(0,s.jsxs)("button",{type:"button",onClick:()=>{var s;return s=e.name,void(i?.(s),r(s),u(!1))},className:"search-bar__option",children:[e.image_url?(0,s.jsx)("img",{src:e.image_url,alt:e.name,className:"search-bar__avatar"}):(0,s.jsx)("span",{className:"search-bar__avatar search-bar__avatar--placeholder",children:e.name.charAt(0)}),(0,s.jsx)("span",{className:"search-bar__option-text",children:e.name})]})},e.name))}):(0,s.jsx)("div",{className:"search-bar__empty",children:l})})]})})}function t({lives:e,maxLives:a=10}){let c=Math.max(0,Math.min(100,e/a*100));return(0,s.jsx)("div",{className:"life-bar__track",children:(0,s.jsxs)("div",{className:"life-bar__fill",style:{width:`${c}%`},children:[e,"/",a]})})}var i=e.i(97936),l=e.i(1892),n=e.i(17927);function d(){let e=(0,c.useRouter)(),[d,o]=(0,a.useState)(""),[m,u]=(0,a.useState)(10),[h,_]=(0,a.useState)([]),[g,p]=(0,a.useState)(!1),[x,j]=(0,a.useState)(!1),[N,v]=(0,a.useState)(null),[w,f]=(0,a.useState)([]),[b,S]=(0,a.useState)(!0),[C,y]=(0,a.useState)(!1),L=()=>new Date().toISOString().slice(0,10),k="realingdle:game-state";(0,a.useEffect)(()=>{$()},[]),(0,a.useEffect)(()=>{(async()=>{let{data:e}=await n.supabase.auth.getSession();y(e.session?.user?.app_metadata?.role==="admin")})();let{data:e}=n.supabase.auth.onAuthStateChange((e,s)=>{y(s?.user?.app_metadata?.role==="admin")});return()=>{e.subscription.unsubscribe()}},[]);let $=async()=>{try{let e=await (0,l.fetchCharacters)({ascending:!0});if(f(e),e.length>0){let s=Math.floor((new Date().getTime()-new Date(new Date().getFullYear(),0,0).getTime())/864e5)%e.length,a=e[s];v(a);{let e=window.localStorage.getItem(k);if(e)try{let s=JSON.parse(e);s.dateKey===L()&&s.characterId===a.id?(_(s.guesses),u(s.lives),p(s.gameOver),j(s.won)):window.localStorage.removeItem(k)}catch{window.localStorage.removeItem(k)}}}}catch(e){console.error("Error fetching character:",e)}finally{S(!1)}};(0,a.useEffect)(()=>{if(!N)return;let e={dateKey:L(),characterId:N.id,guesses:h,lives:m,gameOver:g,won:x};window.localStorage.setItem(k,JSON.stringify(e))},[N,h,m,g,x]);let A=new Set(h.map(e=>e.toLowerCase())),I=d.trim().length?w.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())).filter(e=>!A.has(e.name.toLowerCase())).map(e=>({name:e.name,image_url:e.image_url})):[],O=(e,a,c="None")=>{let r=new Set(a.map(e=>e.id));return 0===e.length?(0,s.jsx)("span",{className:"guess-chip guess-chip--miss",children:c}):e.map(e=>(0,s.jsx)("span",{className:`guess-chip ${r.has(e.id)?"guess-chip--match":"guess-chip--miss"}`,children:e.name},e.id))};return b?(0,s.jsx)("div",{className:"game",children:(0,s.jsx)("div",{className:"game__container",children:(0,s.jsx)("p",{children:"Loading..."})})}):N?(0,s.jsx)("div",{className:"game",children:(0,s.jsxs)("div",{className:"game__container",children:[(0,s.jsx)("h1",{className:"game__title",children:"Guess the Character"}),(0,s.jsx)(t,{lives:m,maxLives:10}),!g&&(0,s.jsx)("div",{className:"game__search",children:(0,s.jsx)(r,{value:d,onChange:o,onSubmit:e=>{if(g||!N)return;let s=w.find(s=>s.name.toLowerCase()===e.toLowerCase());if(!s)return void o("");if(_([...h,s.name]),s.name.toLowerCase()===N.name.toLowerCase())j(!0),p(!0);else{let e=m-1;u(e),0===e&&p(!0)}o("")},suggestions:I,onSelectSuggestion:e=>o(e),noResultsText:"No characters found",disabled:g})}),g&&(0,s.jsxs)("div",{className:`game__result ${x?"game__result--win":"game__result--lose"}`,children:[(0,s.jsx)("h2",{children:x?"ðŸŽ‰ Congratulations!":"ðŸ˜¢ Game Over"}),(0,s.jsx)("p",{children:x?`You guessed the character "${N.name}" correctly!`:`The character was "${N.name}"`}),C&&(0,s.jsx)("div",{className:"game__actions",children:(0,s.jsx)(i.default,{onClick:()=>{u(10),_([]),p(!1),j(!1),o(""),window.localStorage.removeItem(k),$()},children:"Play Again"})})]}),(0,s.jsx)("div",{className:"game__guesses",children:(0,s.jsx)("ul",{className:"game__guesses-list",children:[...h].reverse().map((e,a)=>{let c=w.find(s=>s.name.toLowerCase()===e.toLowerCase())||null,r=c?.id===N?.id||e.toLowerCase()===N?.name.toLowerCase();if(!c||!N)return(0,s.jsxs)("li",{className:"game__guess-card game__guess-card--unknown",children:[(0,s.jsxs)("div",{className:"game__guess-header",children:[(0,s.jsx)("span",{className:"game__guess-name",children:e}),(0,s.jsx)("span",{className:"game__guess-status",children:"Unknown"})]}),(0,s.jsx)("p",{className:"game__guess-missing",children:"Character not found."})]},a);let t={state:c.state?.id===N.state?.id,age:(c.age??null)===(N.age??null)},i=c.image_url?{"--guess-image":`url(${c.image_url})`}:void 0;return(0,s.jsx)("li",{className:`game__guess-card ${r?"game__guess-card--correct":"game__guess-card--wrong"}`,style:i,children:(0,s.jsx)("div",{className:"guess-card__content",children:(0,s.jsxs)("div",{className:"guess-card__info",children:[(0,s.jsxs)("div",{className:"guess-card__title",children:[(0,s.jsx)("h4",{children:c.name}),c.description&&(0,s.jsxs)("p",{className:"guess-card__quote",children:["â€œ",c.description,"â€"]})]}),(0,s.jsxs)("div",{className:"guess-card__row-group",children:[(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Age"}),(0,s.jsx)("div",{className:"guess-card__chips",children:(0,s.jsx)("span",{className:`guess-chip ${t.age?"guess-chip--match":"guess-chip--miss"}`,children:c.age??"-"})})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"State"}),(0,s.jsx)("div",{className:"guess-card__chips",children:(0,s.jsx)("span",{className:`guess-chip ${t.state?"guess-chip--match":"guess-chip--miss"}`,children:c.state?.name||"-"})})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Classes"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.classes,N.classes)})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--compact",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Races"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.races,N.races)})]})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--stacked",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Occupations"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.occupations,N.occupations)})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--stacked",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Associations"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.associations,N.associations)})]}),(0,s.jsxs)("div",{className:"guess-card__row guess-card__row--stacked",children:[(0,s.jsx)("span",{className:"guess-card__label",children:"Places"}),(0,s.jsx)("div",{className:"guess-card__chips",children:O(c.places,N.places)})]})]})})},a)})})})]})}):(0,s.jsx)("div",{className:"game",children:(0,s.jsxs)("div",{className:"game__container",children:[(0,s.jsx)("h2",{children:"No characters available"}),(0,s.jsx)("p",{children:"Please contact the administrator to add characters."}),(0,s.jsx)(i.default,{onClick:()=>e.push("/"),children:"Back to Home"})]})})}e.s(["default",()=>d],8134)}]);